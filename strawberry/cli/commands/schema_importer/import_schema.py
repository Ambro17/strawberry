import sys
import click

from graphql.error import GraphQLError

from strawberry.cli.commands.schema_importer import sdl_importer


@click.command(
    "import-schema", short_help="Converts SDL from a path to strawberry types"
)
@click.argument("schema", type=str, required=True, nargs=-1)
def import_schema(schema):
    """Parses SDL to strawberry types and prints to console"""
    strawberry_code = ""
    for sdl_file in schema:
        try:
            sdl_string = sdl_importer.file_to_string(sdl_file)
            strawberry_code += sdl_importer.import_sdl(sdl_string)

        except FileNotFoundError:
            print(f"File not found on path: {sdl_file}")
#            sys.exit(1)

        except GraphQLError:
            print(f"File {sdl_file} contains syntax errors")
#            sys.exit(1)

    print(f"# Code autogenerated by strawberry from {schema}")
    click.echo(strawberry_code)
